[gd_scene load_steps=52 format=3 uid="uid://ds0q1crcrv862"]

[ext_resource type="Script" uid="uid://bmxb5i8hj4w5u" path="res://scripts/entities/characters/ZE_Zombie.gd" id="1_rffgv"]
[ext_resource type="Script" uid="uid://b6k13gc2m4e5s" path="res://addons/gecs/ecs/component.gd" id="2_2yl8o"]
[ext_resource type="Script" uid="uid://barikupijl7r7" path="res://scripts/components/ZC_Action.gd" id="3_4i4kv"]
[ext_resource type="Script" uid="uid://c7dv7vmk2ynqt" path="res://scripts/components/characters/ZC_Movement.gd" id="4_rcyyt"]
[ext_resource type="Script" uid="uid://cixmecjncarw5" path="res://scripts/components/ZC_Velocity.gd" id="5_tseq0"]
[ext_resource type="PackedScene" uid="uid://d17pdvgowfg7l" path="res://effects/sounds/zombie_hurt.tscn" id="6_8aduj"]
[ext_resource type="Script" uid="uid://0ndifcnh0nsp" path="res://scripts/components/ZC_Health.gd" id="6_nswy3"]
[ext_resource type="Material" uid="uid://d1jglv2507aak" path="res://materials/skins/zombie_dead.tres" id="7_l1o5o"]
[ext_resource type="Material" uid="uid://bajoa8ksbfb81" path="res://materials/skins/zombie_healthy.tres" id="8_tfdn2"]
[ext_resource type="Script" uid="uid://b8oatb3tdywrh" path="res://scripts/components/characters/ZC_Skin.gd" id="9_7tmu0"]
[ext_resource type="Material" uid="uid://rmfci1rvpdo4" path="res://materials/skins/zombie_hurt.tres" id="9_wwun5"]
[ext_resource type="Script" uid="uid://jokkv7skgimj" path="res://scripts/components/status/ZC_Flammable.gd" id="10_tfdn2"]
[ext_resource type="PackedScene" uid="uid://b13thfox1hd38" path="res://effects/fire_effect.tscn" id="11_7tmu0"]
[ext_resource type="Script" uid="uid://boehksdg08i5l" path="res://scripts/components/characters/ZC_Body_Regions.gd" id="12_j7lgi"]
[ext_resource type="PackedScene" uid="uid://vev1dnehdot4" path="res://effects/sounds/footstep_wood_zombie.tscn" id="14_kwfyu"]
[ext_resource type="Script" uid="uid://dpu6n5g8bpa3g" path="res://scripts/components/characters/ZC_Footstep.gd" id="14_rcyyt"]
[ext_resource type="Script" uid="uid://b7x5tu22015cx" path="res://scripts/components/characters/ZC_Faction.gd" id="16_kwfyu"]
[ext_resource type="Script" uid="uid://gy1d5pnk4rwg" path="res://scripts/components/characters/ZC_Attention.gd" id="17_euqm3"]
[ext_resource type="Script" uid="uid://b0rh6txy38f6h" path="res://scripts/components/characters/ZC_Perception.gd" id="17_ull4n"]
[ext_resource type="Script" uid="uid://b7fgmwfrg0t73" path="res://scripts/components/characters/ZC_Experience.gd" id="18_euqm3"]
[ext_resource type="Script" uid="uid://db2qobebs40ku" path="res://scripts/components/characters/ZC_Behavior.gd" id="20_4i4kv"]
[ext_resource type="PackedScene" uid="uid://bf8cjjumln7y5" path="res://behavior/zombie_aggressive.tscn" id="21_3lyvt"]
[ext_resource type="Script" uid="uid://cv6nlv1qus3o3" path="res://scripts/nodes/triggers/ZN_TriggerVisionCone3D.gd" id="22_ull4n"]
[ext_resource type="Script" uid="uid://cwxhmhhcchnk5" path="res://scripts/behavior/misc/ZB_ZombieVision.gd" id="24_ull4n"]
[ext_resource type="PackedScene" uid="uid://b4406rbr42a1e" path="res://entities/weapons/zombie_melee.tscn" id="27_j7lgi"]
[ext_resource type="Script" uid="uid://d1xf73mn6pulk" path="res://scripts/nodes/actions/ZN_BehaviorStateAction.gd" id="27_u6a8x"]
[ext_resource type="Script" uid="uid://bg4w2cfxcm0m7" path="res://scripts/nodes/triggers/ZN_TriggerArea3D.gd" id="28_0ios3"]
[ext_resource type="Script" uid="uid://daa5v82rpm7ih" path="res://scripts/nodes/conditions/ZN_EventCondition.gd" id="29_lpvjo"]
[ext_resource type="Script" uid="uid://b7fl0650sjefs" path="res://scripts/nodes/actions/ZN_AreaAction.gd" id="30_rmak2"]
[ext_resource type="Script" uid="uid://dejf0mustesyw" path="res://scripts/nodes/actions/ZN_BehaviorBlackboardAction.gd" id="31_getlk"]
[ext_resource type="Script" uid="uid://dlpeis5tgmelp" path="res://scripts/nodes/actions/ZN_EntityAction.gd" id="35_0f2mi"]
[ext_resource type="Script" uid="uid://62vhg4wr8feb" path="res://scripts/nodes/ZN_EntityPhysicsLock.gd" id="35_4i4kv"]
[ext_resource type="Script" uid="uid://dbj456ofx8mw1" path="res://scripts/nodes/actions/ZN_BranchAction.gd" id="35_mn8kb"]
[ext_resource type="Script" uid="uid://djqo74flocpe0" path="res://scripts/nodes/actions/ZN_ExperienceAction.gd" id="36_u6a8x"]

[sub_resource type="Resource" id="Resource_0ios3"]
script = ExtResource("3_4i4kv")
actions = Dictionary[int, NodePath]({
33: NodePath("DeathBranch")
})
metadata/_custom_type_script = "uid://barikupijl7r7"

[sub_resource type="Resource" id="Resource_4i4kv"]
script = ExtResource("17_euqm3")
faction_scores = null
metadata/_custom_type_script = "uid://gy1d5pnk4rwg"

[sub_resource type="Resource" id="Resource_u6a8x"]
script = ExtResource("20_4i4kv")
state_machine = NodePath("Node3D/Behavior")
metadata/_custom_type_script = "uid://db2qobebs40ku"

[sub_resource type="Resource" id="Resource_8aduj"]
script = ExtResource("12_j7lgi")
regions = Dictionary[NodePath, float]({
NodePath("HeadShape"): 5.0
})
metadata/_custom_type_script = "uid://boehksdg08i5l"

[sub_resource type="Resource" id="Resource_ull4n"]
script = ExtResource("18_euqm3")
base_xp = 750
metadata/_custom_type_script = "uid://b7fgmwfrg0t73"

[sub_resource type="Resource" id="Resource_euqm3"]
script = ExtResource("16_kwfyu")
faction_name = "hostile_zombies"
metadata/_custom_type_script = "uid://b7x5tu22015cx"

[sub_resource type="Resource" id="Resource_jpnnd"]
script = ExtResource("10_tfdn2")
effect_path = NodePath("Effects/FireEffect")
metadata/_custom_type_script = "uid://jokkv7skgimj"

[sub_resource type="Resource" id="Resource_sn1gh"]
script = ExtResource("14_rcyyt")
raycast = NodePath("RayCast3D")
sounds = Dictionary[String, PackedScene]({
"unknown": ExtResource("14_kwfyu")
})
metadata/_custom_type_script = "uid://dpu6n5g8bpa3g"

[sub_resource type="Resource" id="Resource_4bumh"]
script = ExtResource("6_nswy3")
hurt_sound = ExtResource("6_8aduj")
metadata/_custom_type_script = "uid://0ndifcnh0nsp"

[sub_resource type="Resource" id="Resource_kwfyu"]
script = ExtResource("4_rcyyt")
metadata/_custom_type_script = "uid://c7dv7vmk2ynqt"

[sub_resource type="Resource" id="Resource_mn8kb"]
script = ExtResource("17_ull4n")
metadata/_custom_type_script = "uid://b0rh6txy38f6h"

[sub_resource type="Resource" id="Resource_wwun5"]
script = ExtResource("9_7tmu0")
material_healthy = ExtResource("8_tfdn2")
material_hurt = ExtResource("9_wwun5")
material_dead = ExtResource("7_l1o5o")
skin_shapes = Array[NodePath]([NodePath("Node3DBody/CSGCylinder3D"), NodePath("Node3DBody/CSGSphere3D")])
metadata/_custom_type_script = "uid://b8oatb3tdywrh"

[sub_resource type="Resource" id="Resource_7tmu0"]
script = ExtResource("5_tseq0")
metadata/_custom_type_script = "uid://cixmecjncarw5"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_iwqt7"]

[sub_resource type="SphereShape3D" id="SphereShape3D_uqboj"]
radius = 0.25

[sub_resource type="SphereShape3D" id="SphereShape3D_k1ix1"]
radius = 15.0

[sub_resource type="SphereShape3D" id="SphereShape3D_ctl57"]
radius = 2.0

[node name="Zombie" type="RigidBody3D" node_paths=PackedStringArray("physics", "vision", "current_weapon", "inventory_node", "weapon_node")]
collision_layer = 16
collision_mask = 31
mass = 20.0
script = ExtResource("1_rffgv")
physics = NodePath("Node3D/ZB_ZombiePhysics")
vision = NodePath("Node3D/VisionCone3D/ZB_ZombieVision")
current_weapon = NodePath("Inventory/ZombieMelee")
inventory_node = NodePath("Inventory")
weapon_node = NodePath("WeaponMarker")
component_resources = Array[ExtResource("2_2yl8o")]([SubResource("Resource_0ios3"), SubResource("Resource_4i4kv"), SubResource("Resource_u6a8x"), SubResource("Resource_8aduj"), SubResource("Resource_ull4n"), SubResource("Resource_euqm3"), SubResource("Resource_jpnnd"), SubResource("Resource_sn1gh"), SubResource("Resource_4bumh"), SubResource("Resource_kwfyu"), SubResource("Resource_mn8kb"), SubResource("Resource_wwun5"), SubResource("Resource_7tmu0")])

[node name="Node3DBody" type="Node3D" parent="."]

[node name="CSGCylinder3D" type="CSGCylinder3D" parent="Node3DBody"]
material = ExtResource("8_tfdn2")

[node name="CSGSphere3D" type="CSGSphere3D" parent="Node3DBody"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.75, -0.5)
radius = 0.25
material = ExtResource("8_tfdn2")

[node name="BodyShape" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_iwqt7")
metadata/surface_type = &"zombie"

[node name="HeadShape" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.75, -0.5)
shape = SubResource("SphereShape3D_uqboj")
metadata/surface_type = &"zombie"

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
simplify_path = true

[node name="Node3D" type="Node3D" parent="."]

[node name="Behavior" parent="Node3D" node_paths=PackedStringArray("entity") instance=ExtResource("21_3lyvt")]
entity = NodePath("../..")

[node name="ZB_IsPlayerInArea" parent="Node3D/Behavior/Transitions/Any_Attack" index="0" node_paths=PackedStringArray("detection_area")]
detection_area = NodePath("../../../../AttackArea3D")

[node name="ZB_IsPlayerVisible" parent="Node3D/Behavior/Transitions/Any_Chase" index="0" node_paths=PackedStringArray("vision_cone")]
vision_cone = NodePath("../../../../VisionCone3D")

[node name="VisionCone3D" type="Area3D" parent="Node3D" node_paths=PackedStringArray("vision_test_ignore_bodies")]
transform = Transform3D(-4.371139e-08, -1, 0, 1, -4.371139e-08, 0, 0, 0, 1, 0, 0, 0)
collision_layer = 16
collision_mask = 27
script = ExtResource("22_ull4n")
vision_test_mode = 0
vision_test_ignore_bodies = [NodePath("../..")]
collision_layer_ = 16
collision_mask_ = 27

[node name="ZB_ZombieVision" type="Node" parent="Node3D/VisionCone3D" node_paths=PackedStringArray("vision_area", "entity")]
script = ExtResource("24_ull4n")
vision_area = NodePath("..")
entity = NodePath("../../..")
metadata/_custom_type_script = "uid://cwxhmhhcchnk5"

[node name="DetectionArea3D" type="Area3D" parent="Node3D" node_paths=PackedStringArray("parent_entity")]
collision_layer = 16
collision_mask = 24
script = ExtResource("28_0ios3")
track_colliders = true
parent_entity = NodePath("../..")
trigger_on_empty = true
trigger_on_body_interval = false
metadata/_custom_type_script = "uid://bg4w2cfxcm0m7"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Node3D/DetectionArea3D"]
shape = SubResource("SphereShape3D_k1ix1")

[node name="EnterBranch" type="Node" parent="Node3D/DetectionArea3D"]
script = ExtResource("35_mn8kb")
metadata/_custom_type_script = "uid://dbj456ofx8mw1"

[node name="ZN_EventCondition" type="Node" parent="Node3D/DetectionArea3D/EnterBranch"]
script = ExtResource("29_lpvjo")
allow_events = Array[int]([10])
metadata/_custom_type_script = "uid://daa5v82rpm7ih"

[node name="ZN_AreaAction" type="Node" parent="Node3D/DetectionArea3D/EnterBranch" node_paths=PackedStringArray("area")]
script = ExtResource("30_rmak2")
area = NodePath("../../../VisionCone3D")
active = 1
metadata/_custom_type_script = "uid://b7fl0650sjefs"

[node name="EmptyBranch" type="Node" parent="Node3D/DetectionArea3D"]
script = ExtResource("35_mn8kb")
metadata/_custom_type_script = "uid://dbj456ofx8mw1"

[node name="ZN_EventCondition" type="Node" parent="Node3D/DetectionArea3D/EmptyBranch"]
script = ExtResource("29_lpvjo")
allow_events = Array[int]([1])
metadata/_custom_type_script = "uid://daa5v82rpm7ih"

[node name="ZN_AreaAction" type="Node" parent="Node3D/DetectionArea3D/EmptyBranch" node_paths=PackedStringArray("area")]
script = ExtResource("30_rmak2")
area = NodePath("../../../VisionCone3D")
active = 0
metadata/_custom_type_script = "uid://b7fl0650sjefs"

[node name="ZN_BehaviorStateAction" type="Node" parent="Node3D/DetectionArea3D/EmptyBranch" node_paths=PackedStringArray("state_machine")]
script = ExtResource("27_u6a8x")
state_machine = NodePath("../../../Behavior")
try_transition = false
metadata/_custom_type_script = "uid://d1xf73mn6pulk"

[node name="AttackArea3D" type="Area3D" parent="Node3D" node_paths=PackedStringArray("parent_entity")]
collision_layer = 16
collision_mask = 24
script = ExtResource("28_0ios3")
track_colliders = true
parent_entity = NodePath("../..")
trigger_on_empty = true
trigger_on_body_interval = false
metadata/_custom_type_script = "uid://bg4w2cfxcm0m7"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Node3D/AttackArea3D"]
shape = SubResource("SphereShape3D_ctl57")
debug_color = Color(0.7, 0, 0, 0.41960785)

[node name="EnterBranch" type="Node" parent="Node3D/AttackArea3D"]
script = ExtResource("35_mn8kb")
metadata/_custom_type_script = "uid://dbj456ofx8mw1"

[node name="ZN_EventCondition" type="Node" parent="Node3D/AttackArea3D/EnterBranch"]
script = ExtResource("29_lpvjo")
allow_events = Array[int]([10])
metadata/_custom_type_script = "uid://daa5v82rpm7ih"

[node name="ZN_BehaviorBlackboardAction" type="Node" parent="Node3D/AttackArea3D/EnterBranch"]
script = ExtResource("31_getlk")
set_key = &"target_player"
metadata/_custom_type_script = "uid://dejf0mustesyw"

[node name="ZN_BehaviorStateAction" type="Node" parent="Node3D/AttackArea3D/EnterBranch" node_paths=PackedStringArray("state_machine", "set_state")]
script = ExtResource("27_u6a8x")
state_machine = NodePath("../../../Behavior")
set_state = NodePath("../../../Behavior/States/ZB_State_Attack")
try_transition = false
metadata/_custom_type_script = "uid://d1xf73mn6pulk"

[node name="EmptyBranch" type="Node" parent="Node3D/AttackArea3D"]
script = ExtResource("35_mn8kb")
metadata/_custom_type_script = "uid://dbj456ofx8mw1"

[node name="ZN_EventCondition" type="Node" parent="Node3D/AttackArea3D/EmptyBranch"]
script = ExtResource("29_lpvjo")
allow_events = Array[int]([1])
metadata/_custom_type_script = "uid://daa5v82rpm7ih"

[node name="ZN_BehaviorStateAction" type="Node" parent="Node3D/AttackArea3D/EmptyBranch" node_paths=PackedStringArray("state_machine", "set_state")]
script = ExtResource("27_u6a8x")
state_machine = NodePath("../../../Behavior")
set_state = NodePath("../../../Behavior/States/ZB_State_Chase")
try_transition = false
metadata/_custom_type_script = "uid://d1xf73mn6pulk"

[node name="ZB_ZombiePhysics" type="Node" parent="Node3D" node_paths=PackedStringArray("entity_body", "entity")]
script = ExtResource("35_4i4kv")
entity_body = NodePath("../..")
entity = NodePath("../..")
metadata/_custom_type_script = "uid://62vhg4wr8feb"

[node name="Effects" type="Node3D" parent="."]

[node name="FireEffect" parent="Effects" instance=ExtResource("11_7tmu0")]
visible = false

[node name="Inventory" type="Node3D" parent="."]

[node name="ZombieMelee" parent="Inventory" instance=ExtResource("27_j7lgi")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.44078487, -0.60281074)

[node name="RayCast3D" type="RayCast3D" parent="."]

[node name="WeaponMarker" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.44078487, -0.60281074)

[node name="DeathBranch" type="Node" parent="."]
script = ExtResource("35_mn8kb")
metadata/_custom_type_script = "uid://dbj456ofx8mw1"

[node name="ZN_ExperienceAction" type="Node" parent="DeathBranch"]
script = ExtResource("36_u6a8x")
metadata/_custom_type_script = "uid://djqo74flocpe0"

[node name="ZN_AreaAction" type="Node" parent="DeathBranch" node_paths=PackedStringArray("area")]
script = ExtResource("30_rmak2")
area = NodePath("../../Node3D/DetectionArea3D")
active = 0
metadata/_custom_type_script = "uid://b7fl0650sjefs"

[node name="ZN_AreaAction2" type="Node" parent="DeathBranch" node_paths=PackedStringArray("area")]
script = ExtResource("30_rmak2")
area = NodePath("../../Node3D/AttackArea3D")
active = 0
metadata/_custom_type_script = "uid://b7fl0650sjefs"

[node name="ZN_AreaAction3" type="Node" parent="DeathBranch" node_paths=PackedStringArray("area")]
script = ExtResource("30_rmak2")
area = NodePath("../../Node3D/VisionCone3D")
active = 0
metadata/_custom_type_script = "uid://b7fl0650sjefs"

[node name="ZN_BehaviorStateAction" type="Node" parent="DeathBranch" node_paths=PackedStringArray("state_machine")]
script = ExtResource("27_u6a8x")
state_machine = NodePath("../../Node3D/Behavior")
set_active = 0
try_transition = false
metadata/_custom_type_script = "uid://d1xf73mn6pulk"

[node name="ZN_EntityAction" type="Node" parent="DeathBranch" node_paths=PackedStringArray("entity")]
script = ExtResource("35_0f2mi")
entity = NodePath("../../Inventory/ZombieMelee")
remove = true
metadata/_custom_type_script = "uid://dlpeis5tgmelp"

[editable path="Node3D/Behavior"]
