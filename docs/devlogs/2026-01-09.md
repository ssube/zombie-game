### Summary

I added ladders as trigger areas that change player movement from forward/backward to up/down. You can still move left/right to fall off of the ladder.

I added objectives to all of the demo levels with custom objectives appropriate to each level. These will help guide players through the demo. I also added medkits to every level (not all are easy to find) and more weapon sounds for melee swings and thrown weapons.

I replaced the medkit texture with a less pixelated one and fixed the audio bus for many sounds, moving effects and voices back to their correct buses so the volume sliders work as expected.

I fixed the interactive shimmer staying active after picking up items (especially the shotgun and pistol). I fixed the weird texture alignment on the fishing pier sidewalk by moving the seam to look like the edge between the sidewalk and the curb.

I fixed footsteps not playing in some areas - the player and zombie footsteps were both missing some surface types. Recent changes to the maps had introduced brushes with multiple surface types. I split up the map entities correctly and added footstep sounds for concrete, brick, and wood.

I fixed melee weapons not hitting things and thrown weapons falling directly to the ground. The IKCC documentation says it should run in the physics thread, so I moved it there, but that broke most physics-based weapons. I moved it back to the main thread until I can figure out the issue. I also fixed a few more subtitles and an issue where release builds would have the audio tab hidden but cheats visible.

### Progress

- added ladders
	- ladders are trigger areas that change player movement from forward/backward to up/down
	- you can still move left/right to fall off of the ladder
- added objectives to all of the levels
    - each of the demo levels now has custom objectives appropriate to that level
    - these objectives will help guide you through the demo
- added medkits to every level
	- not all of them are easy to find, but every level has one
- added more weapon sounds
	- added a sound when you swing a melee weapon (the baseball bat and crowbar)
	- added a sound when you throw a thrown weapon (the flare and rocks)
- replaced the medkit texture with a less pixelated one
	- I liked having the medkit red, but the texture had too much pixelated noise
- fixed the audio bus for many sounds
	- moved effects and voices back to their correct buses, so the volume sliders will work as expected
- fixed the interactive shimmer staying active after you picked up an item (especially the shotgun and pistol)
	- picking up items and interacting with them now turns off the shimmer
- fixed the weird texture alignment on the fishing pier sidewalk
	- the concrete texture is not perfectly seamless, so I moved the seam over to look like the edge between the sidewalk and the curb
- fixed the footsteps not playing in some areas
	- the player and zombie footsteps were both missing some surface types
	- recent changes to the maps had introduced some brushes with multiple surface types, which changed which one was being registered by the surface detection system
	- split up the map entities correctly and added footstep sounds for concrete, brick, and wood
- fixed the melee weapons not hitting things and thrown weapons falling directly to the ground
	- the documentation for the IKCC controller says that it should run in the physics thread, so I moved it to the physics thread
	- that broke most physics or area-based weapons
	- moved the IKCC controller back to the main thread until I can figure out the issue
- fixed a few more subtitles that were sentence case rather than Title Case
- fixed an issue where release builds would have the audio tab in the options menu hidden, but the cheats tab was visible

### Next Up

3. [x] Bug: bullets are heading off in weird directions
	1. Aiming at a certain spot targets an invisible baseball bat
		1. This is where the baseball bat from your inventory exists in the real world (outside of your backpack)
		2. I need to make sure inventory items have their collision disabled
			1. There should be a flag for equipped items to enable physics, for things like the bat, shields, and some guns
4. Fix the shadow moire when the player has a flashlight
5. Adaptive aim bugs out if you look straight up (or as close as possible)
- Replace the trigger area flags with node pointers to the branch
- Set up the action context class
- Add a tired sound when you don't have enough stamina to do something (jump, attack, etc)
- Something like ladders that follows a 3D path
	- temporarily attach the player to a `PathFollow3D` node
	- forward/backward controls would control the progress along the path
	- left/right could perform a secondary function like tipping back and forth
	- could be used to implement minecarts, f.ex
		- that would require linking the tracks together into one long path
- level tools:
	- check for statics in the entities node and vice versa
- [x] add a scene for caching effects
	- add every weapon, fire, rain, etc
	- mute the main audio bus
	- play every weapon effect
	- show a "Compiling Shaders" message
	- can estimate a progress bar based on the number of entities * the number of effects

### New Physics Bugs

- a bunch of weird physics bugs have appeared
	- the melee weapons are not colliding with anything
	- thrown rocks are falling to the ground instead of flying
	- player footsteps are not playing in the debug level
- after stashing the latest changes, they are still occurring, so they happened in some earlier commit
	- true for melee and rocks
- the player footsteps is because of some changes I made to how brushes were grouped in the map
	- the rooms are now being registered as brick, there is no sound effect for brick, and the footstep system is not falling back to unknown
- the other physics bugs could be related to the recent equipment changes or something about how the item positions are being set
- bisect:
	- good: bbe2dc62472c76634cf1ca8569eca49c2d272bd9
	- bad: 69aa21f4ed29bfce9296976359bd3a1cc848d375

```
> git bisect bad
5fe3ffb810831fc0eb99a4eceafc17db9cfd6702 is the first bad commit
commit 5fe3ffb810831fc0eb99a4eceafc17db9cfd6702
Author: Sean Sube
Date:   Thu Jan 8 21:28:41 2026 -0600

    make sure IKCC slide is only called from the physics thread

 scripts/entities/characters/ZE_Player_IKCC.gd | 8 ++++++++
 scripts/systems/ZS_Player.gd                  | 2 --
 2 files changed, 8 insertions(+), 2 deletions(-)
```

which contains:

```
> git diff 5fe3ffb810831fc0eb99a4eceafc17db9cfd6702..5fe3ffb810831fc0eb99a4eceafc17db9cfd6702~1
diff --git a/scripts/entities/characters/ZE_Player_IKCC.gd b/scripts/entities/characters/ZE_Player_IKCC.gd
index 6b503ea..9b4b253 100644
--- a/scripts/entities/characters/ZE_Player_IKCC.gd
+++ b/scripts/entities/characters/ZE_Player_IKCC.gd
@@ -606,11 +606,6 @@ static func solve_dynamic_constraints(
        return new_velocity


-func _physics_process(_delta: float) -> void:
-       if not is_zero_approx(velocity.length_squared()):
-               ikcc_move_and_slide()
-
-
 ## Call this in '_physics_process' to simulate body movement.
 ## Returns true if collision happened.
 func ikcc_move_and_slide() -> bool:
@@ -620,9 +615,6 @@ func ikcc_move_and_slide() -> bool:
                        get_physics_process_delta_time() if Engine.is_in_physics_frame()
                        else get_process_delta_time()
        )
-
-       assert(Engine.is_in_physics_frame(), "IKCC: 'ikcc_move_and_slide' should be called from '_physics_process'!")
-
        previous_position = body.global_position

        # Take axis lock into account
diff --git a/scripts/systems/ZS_Player.gd b/scripts/systems/ZS_Player.gd
index d32df06..fdf2692 100644
--- a/scripts/systems/ZS_Player.gd
+++ b/scripts/systems/ZS_Player.gd
@@ -73,6 +73,8 @@ func process(entities: Array[Entity], _components: Array, delta: float):
                # Sync to CharacterBody3D (Node assumed attached to entity)
                var speed_multiplier := EntityUtils.get_speed_multiplier(entity)
                body.velocity = velocity.linear_velocity * speed_multiplier
+               body.ikcc_move_and_slide()
+               _handle_collisions(body, delta)

                _process_screen_effects(entity, delta)
                _process_heard_noises(entity)
```

### Action Context

Rather than continue to fight with the order of the parameters to the action events, I think it is time to start using a context object with all of the parameters.

Potential data structure:

```
class ActionActor:
    Entity
    Body
    Node
    Shape

class ActionMenu:
    Menu
    Control

class ActionContext:
    event: ActionEvent
    source: ActionActor
    actor: ActionActor
    menu: ActionMenu?
    extra_data: Dictionary[StringName, Variant]
```
The signature to emit will still be `emit_action(event, actor, data)` and the additional fields will be populated internally by looking up and down the scene tree and using the parent_entity property to identify the parents. That resolution will typically only extend up the tree, so if a shape is given then the body can be populated, and if the body is known then the entity can be populated. The opposite is not possible since an entity may have many bodies and bodies may have many shapes, so picking the correct one is impossible without some additional knowledge.

That additional knowledge may come in the form kf a raycast.
