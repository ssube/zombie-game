### Summary

I converted several behaviors into action nodes: ignite on hit, explode on death, transfer XP on use, and transfer XP on death.

I set up the OptionsManager with subclasses for cheats, graphics, and audio.

I added an end-of-level screen with flags to show points/experience and killed-by message. It's connected to a game state and provides the next level.

I added CLI options for mod support: loading extra PCK files and switching campaigns. I added a debug campaign with the debug levels and an option to merge campaigns.

I fixed zombies not doing damage because of a missing relationship. The killed-by relationship was not being added until after health was removed, so the observer would run before the relationship existed. The solution was to have the system add relationships before modifying the health value using the speculative updated value.

I added a variable trigger timer, random branch action, title screen to the campaign resource, end images to levels, more options to the node action (visible/invisible, disabled/not), snap to nav mesh option to spawn action, level action types (loaded, complete), an action branch that iterates over a group, a basic version of sky switching, and the quake lights addon.

### Progress

- [x] Convert the following into action nodes:
	- [x] ignite on hit
	- [x] explode on death
	- [x] transfer XP on use
	- [x] transfer XP on death
- [x] Set up the OptionsManager
	- [x] Subclasses:
		- [x] Cheats
		- [x] Graphics
		- [x] Audio
- [x] Add an end-of-level screen
	- Can this be combined with the game over screen?
		- No, different labels and button count
	- [x] Flag to show points/experience
	- [x] Flag to show killed-by message
	- [x] Connect it to a game state and provide the next level
- [x] Add CLI options for mod support
	- [x] Load extra PCK files
	- [x] Switch campaign
- [x] Add a debug campaign with the debug levels
- [x] Add an option to merge campaigns
	- [ ] Make debug builds load main + debug campaigns?
- [ ] Move command line helpers to methods on an args class?
- [x] add variable trigger timer
- [x] add random branch action
- [x] add a title screen to the campaign resource
	- [x] and show it on the main menu
- [x] add end images to levels
- [x] fix zombies not doing damage because of missing relationship
- [ ] fix barrel's killed-by relationship
- [x] add more options to node action
	- [x] visible/invisible
	- [x] disabled/not
- [x] add snap to nav mesh option to spawn action
- [x] add some level action types
	- [x] loaded
	- [x] complete
- [x] add an action branch that will iterate over a group
- [x] add a basic version of sky switching
- [x] add quake lights addon

### TODOs

- figure out how to switch skies
- find a better place for the skies folder

### Damage Relationships

I ran into a problem with the order of operations when dealing damage and attributing kills.

Problem: the killed-by relationship is not added until after the health is removed, so the ZO_Health on-change handler will run before the relationship exists, and will not be able to find the actor for events.

Having both a system and an observer handling the same thing is weird, since there are no timers, but the system does handle the relationships while the observer handles the outcomes.

Solutions:
- Everything in the observer could be moved into the system, but it would not be as clean and would include more code running each frame.
- Using a relationship for last-hit or most-hit could work, and could be added any time there is new damage, not just after death.
	- Using this.
- Calculating the post-change damage and using that to add the correct relationships before modifying the health could work, but removes the clamp logic from the health component.
	- Using this to apply the relationships.

Current solution:
- Most of the threshold logic is still located in the observer
- The system adds relationships before modifying the health value
- The observer can use those relationships to populate the actor for actions
- The system uses the speculative updated value to add relationships, since that only needs to know if the health will be <= 0

### The Sky

I started thinking about how to implement the sky/weather system and where it should live in the scene tree.

- should it be part of the game outside of the level?
	- I don't like that much since it prevents levels from adding their own sky
- could it be an ECS entity?
	- it could, but that doesn't make very much sense
	- it would allow some component to be attached to the sky, tracking the time
- could it be a component on the player?
	- this makes the most sense so far, considering it would allow new levels to increment the player's time, which would then travel back with them to the previous levels
- should there be a time or weather system/observer?
	- watching the time/weather component on the player?
	- a system could increment time as it passes (* some rate of time cheat)
	- an observer would only change the sky when the player's sky property changes
- both:
	- time is a system that keeps time
	- sky/weather is an observer like skin
	- thunder and rain are probably their own systems
