### Summary

Mostly combat improvements today: critical hits which can double as armored areas, only enable melee weapon hit areas while they are moving, and a weapon effect type for melee swings.

I also worked on gameplay and persistence: basic support for counter objectives (do N of X) and started implementing a save manager singleton. I split up the menu scenes and started showing real save games in the save/load menus.

### Progress

- implemented critical hit areas
	- collision shapes can be designated as critical hit areas
	- each area has a damage multiplier
	- zombie headshots now kill them instantly
- toggle damage areas during melee attacks
	- previously, melee weapons could hit an enemy and do damage at any time, even if they were not being swung
	- this activates the damage areas when the swing starts and disables them after the attack
	- currently disables them after cooldown/back swing, but that could happen after the forward swing (no damage on back swing)
- minor changes in weapon effects
	- added melee weapon effects to the implementation
	- noticed that effects are not showing their subtitles
- started implementing save manager
	- moved save game functionality from menu to manager
	- save objectives functionality still in objective manager, which is fine for now
- started implementing counter objectives
	- completing an objective component will set a flag and/or increment a counter by a given score
	- score can be positive or negative and the objective node can have a target of N or 0, so you can count up or down (or both, some targets are positive points and some are negative, like police target practice)
	- once the objective component has been completed, it can't be completed again, so you can't do "shoot the same zombie 3 times" yet
	- you can do "shoot 3 different zombies", because then each zombie has its own objective component
- split up menu scenes
	- split each menu into its own scene
	- linked them with signals and slightly better callbacks
- show real save games in the save and load menus
	- lists save games from the `user://saves` folder (by default, `~/.local/share/godot/app_userdata/Zombie\ Game/saves/`)
	- does not include modified date/time yet
	- should sort by modified time

### TODOs

- some sounds and/or subtitles are not playing/being shown
	- like the sound when you use the medkit, because it doesn't have one
- the save and load game lists need placeholder text when they are empty
- the save and load game lists need to be implemented to show real saves

### Ideas

- add loading menu tips to each level?
	- it would be cool to preload them for the next level, but I don't want to deal with a central resource that holds all of the loading hints, it would be better to keep them within the level

### Menus

Should menus be a singleton?

There are many parts of the code that currently call into the menu system, which would be easier if menus were a singleton, but you can also argue that all of that logic should be moved into the systems and observers, which already have access to the menu.

The hardest part is sounds, which can autoplay and be scattered throughout the scene tree. It would be nice if sounds could show their own subtitles, but they could also accomplish that by using the ECS world to find nearby players and pushing a subtitle to each player.

I added a hints field to the loading screen, which is not really visible right now because all of the levels are preloaded, but will be visible once the levels use threaded loading, especially in the web version. The hints are all hard-coded suggestions about fighting zombies for now.

Grid control with row/column spanning:
https://godotengine.org/asset-library/asset/2843

#### Breaking up menus

I have started breaking the menus into separate scenes, with events to link them. The implementation of the event handlers has not improved much and could still be untangled more, but this is an improvement when editing the menus, since they no longer need to be shown and hidden. It might be a good idea to split up some of the options tab for the same reason, although those are much more closely coupled than the other menus.

There is a base menu class with the concepts of apply and back, which most of the menus have in some form. Those are linked to the root menu, which keeps track of the current and previous menus, allowing a simple way of backtracking without needing to know which menu referred you. The more complex handlers, like expiring actions from the action queue or showing hints in the loading screen, are now handled within their own menu script and won't impact each other. The base menu has three events:

- on show
- on hide
- on update

With the default on-show handler simply calling on-update to update the contents of the menu. The root menu still handles visibility, since it has links to all of the other menus and can easily hide them.
