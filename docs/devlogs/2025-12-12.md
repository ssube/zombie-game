### Summary

I implemented surface types for things like bullet holes and blood effects. This uses node metadata and maps to a lookup table in the decal manager. I also set up footstep sounds that use surface detection with a ray below the character.

I moved most of the targeting and velocity code from the character base entity into a proper movement system. This fixed zombie footsteps, which were broken because zombies were not populating their velocity component. I also switched to using the noise component for subtitles.

### Progress

- implemented surface types
	- simplified version of surface detection, using node metadata with the `surface_type` property
	- values are mapped to a lookup table in the decal manager
	- works for bullet hole sprites and blood effects that need to spawn at the point of contact
	- surface decal scenes can contain sounds, but the projectile system still has its own mapping for those, so that it can display subtitles
	- surface types are not a fixed list, any string that is not found in the mapping will fall back to a default
	- surface detection requires a raycast at the moment to determine which collision shape was touched
	- planned surface types:
		- grass
		- human
		- metal
		- snow
		- stone
		- water
		- wood
		- zombie
	- needs to be integrated with Trenchbroom import pipeline
		- might be able to use FGD entity types, but would require a lot of setup and correct assignment in Trenchbroom
		- checking the surface texture would be simpler while mapping, but might require forking func_godot
		- func_godot doesn't have any way to set the metadata that I can see, but it does have a function for generating collision shapes that would be easy to modify or hook into
- footstep sounds
	- footstep sounds need to use surface detection with a ray pointing down below the character
	- footsteps should play on an interval, modified by the entity's velocity (sprinting or sneaking)
	- zombies do not use the velocity component, so they are always failing the movement check
	- ~~I put in a hack for zombies until I can make them populate and use their velocity component correctly~~ removed this
		- this will probably allow me to move most of the movement code out of ZE_Character and into ZS_Movement, if done correctly
		- the movement code needs to be aware of the type of body that it's moving (rigid, static, or character) because they all use different methods of movement (and rigid can use the same tweens as static when it's kinematically frozen)
- set up movement system and reduced movement code in character entity
	- I set up a movement system and moved most of the targeting and velocity calculation code from the character base entity into the movement system
	- this is a lot more manageable than having characters do their own movement and fixes the velocity component not populating on zombies
	- zombie footsteps now work correctly
- switched to using the noise component for subtitles
	- this let me fix the subtitles for most of the noises, since the sound node can now add a relationship to any players within range
	- sets the foundation for enemy noise detection as well

### TODOs

- ~~refactor movement code into the proper system (before open-sourcing the code)~~
- ~~remove transform component unless I can think of a good use~~
- ~~finish writing the readme~~
- ~~fix the explosion sound~~
- ~~use relationship to connect a subtitle component to players within range~~
- ~~fix ZE_Base adding multiple objective components on reload~~
- optimize the zombie behavior using a nav agent and proximity signals
- figure out how to save the location of entities without the transform component
	- the location needs to be persistent, so it may be linked to the persistence component
- ~~add an option for subtitles~~
- fix subtitles playing double and quadruple
- fix explosion physics not pushing things around
- record a demo with sound

### Using the Movement System More

Implementing footsteps has me looking into the movement code again, and having the movement methods in ZE_Character has never seemed right, since they bypass the ECS world for the most part (although they are attached to an entity within it). While implementing footsteps, I realized that zombies were not populating their velocity component at all, which was preventing them from emitting footsteps (which have a velocity check).

If the character movement methods set the values in the velocity component instead (which may require adding a target position property), then the existing movement system could process them and apply the movement, based on the body type. This could even include the player's movement, based on the CharacterBody3D type.
