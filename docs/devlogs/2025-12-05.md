### Summary

I split up the maps for each level, including the multi-story buildings. I defined requirements for the objective system and started thinking about how to structure objectives within each level. I also started designing the dialogue system and figured out how it will fit into the HUD.

I ran into a problem with zombies navigating through doors, since the hotel interior already has more doors than Godot's navigation mesh layer limit.

### TODOs

- group entities by room in larger maps
- recursively add entities to the ECS world in the world script
- add objective trees to the tasks list
- figure out how to display dialogue
- decide whether to use random clips or dialogue trees
- look into collapsing the objective label when it is empty

### Levels

I split up the maps that will be needed for each level, including the multi-story buildings. Smaller buildings like the gas station, mechanic, sheriff, etc, can have real interiors and don't necessarily need to reload, unless I want to make the interior larger than would be physically possible.

I expect most of the exteriors will be a physically accurate size, or at least something plausibly close, but I need to test that theory using the hotel's dimensions.

One of the walls does not line up quite right in the hotel, probably due to some inconsistent single-wall/double-wall placement, but I need to find that and fix the weird edge, because it is in a noticeable spot.

It would be nice to group entities by room, and would make moving entire rooms later to adjust the map much easier.

#### Objectives

I need to define a list of objectives for each level. For the first pass, they will need to be completed in order. By the time I start building the town level, I want to have multiple and/or optional objectives implemented as well, which may need to show up in a notebook or some other quest log menu. There will not be many quests, but in town, it would be things like "check the sheriff's office for equipment" and "check the gas station for a car", followed by "check the mechanic for a battery", and then "escape from town." Some branching would be useful, but the menu will need some style work.

I need to work on defining the objective tree for each level.

### Dialogue and Survivors

The hotel needs to be populated with some uninfected (visually, at least) characters for the zone 1 pre-outbreak introduction scenes. You will be able to talk to the characters in the intro and the survivors after the outbreak, so there needs to be a dialogue system or place for it in the HUD.

The easiest place would be to put the dialogue into the action bar, but that may not be obvious to players and isn't really central enough, since the interaction happens close to the middle of the screen. Using an optional element that replaces the crosshairs might work, but I don't want to obscure the character being interacted with, either. If there is a popup, it needs to be placed slightly below the target character's face.

I'm not sure if I want to have dialogue trees or simply use single-line soundbytes. Dialogue trees would make things more interactive and are not very difficult to set up, but single-line sounds (maybe a small random selection) would fit the rest of the gameplay and style better.

### HUD

The HUD layout is suffering as more elements are added. The current objective and the action log are at the top, making the log look weirdly out of place when you don't have an objective. This can probably be fixed in the script, and real levels will have objectives, so it's not really much of a problem.

### Navigation

How will zombies know whether or not they can pass through doors? They should be able to open some doors, as well. There are a few options:

- bake the nav mesh without doors and have zombies open doors if they run into one
- bake a separate nav mesh for each door, enable and disable those as the doors open and close

https://docs.godotengine.org/en/latest/tutorials/navigation/navigation_different_actor_area_access.html recommends using nav meshes for each door, assigned to their own layer. That will work, but will also limit the levels to 31 doors max. The hotel interior already has 40-41 doors, so a limit of 31 would limit the levels substantially. The same documentation page recommends against enabling and disabling nav regions, but that would bypass the problem.

> The entire "door" region can also be enabled / disable if required but if disabled will block access for all path queries.
>
> Prefer working with navigation layers in path queries whenever possible as enabling or disabling navigation layers on a region triggers a costly recalculation of the navigation map connections.
